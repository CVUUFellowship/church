<?php

//  PROJECT HONEY POT ADDRESS DISTRIBUTION SCRIPT
//  For more information visit: http://www.projecthoneypot.org/
//  Copyright (C) 2004-2013, Unspam Technologies, Inc.
//  
//  This program is free software; you can redistribute it and/or modify
//  it under the terms of the GNU General Public License as published by
//  the Free Software Foundation; either version 2 of the License, or
//  (at your option) any later version.
//  
//  This program is distributed in the hope that it will be useful,
//  but WITHOUT ANY WARRANTY; without even the implied warranty of
//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//  GNU General Public License for more details.
//  
//  You should have received a copy of the GNU General Public License
//  along with this program; if not, write to the Free Software
//  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
//  02111-1307  USA
//  
//  If you choose to modify or redistribute the software, you must
//  completely disconnect it from the Project Honey Pot Service, as
//  specified under the Terms of Service Use. These terms are available
//  here:
//  
//  http://www.projecthoneypot.org/terms_of_service_use.php
//  
//  The required modification to disconnect the software from the
//  Project Honey Pot Service is explained in the comments below. To find the
//  instructions, search for:  *** DISCONNECT INSTRUCTIONS ***
//  
//  Generated On: Fri, 19 Apr 2013 18:23:08 -0700
//  For Domain: www.cvuuf.org
//  
//  

//  *** DISCONNECT INSTRUCTIONS ***
//  
//  You are free to modify or redistribute this software. However, if
//  you do so you must disconnect it from the Project Honey Pot Service.
//  To do this, you must delete the lines of code below located between the
//  *** START CUT HERE *** and *** FINISH CUT HERE *** comments. Under the
//  Terms of Service Use that you agreed to before downloading this software,
//  you may not recreate the deleted lines or modify this software to access
//  or otherwise connect to any Project Honey Pot server.
//  
//  *** START CUT HERE ***
//  
define('__REQUEST_HOST', 'hpr1.projecthoneypot.org');
define('__REQUEST_PORT', '80');
define('__REQUEST_SCRIPT','/cgi/serve.php');
//  
//  *** FINISH CUT HERE ***
//  

define('__HPOT_TAG1',    '161726b550ae24f29c0beca6e922deea');
define('__HPOT_TAG2',    'afc852739012046f582665146b7ef655');
define('__HPOT_TAG3',    '34aa2473d1aa4705f92165addfe297ff');

define('__CLASS_STYLE_1','sweloc');
define('__CLASS_STYLE_2','himu');

define('__DIV1',         'h728d49ac');

define('__VANITY_L1',    'MEMBER OF PROJECT HONEY POT');
define('__VANITY_L2',    'Spam Harvester Protection Network');
define('__VANITY_L3',    'provided by Unspam');

define('__DOC_TYPE1',    '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">\n');
define('__HEAD1',        '<html>\n<head>\n');
define('__HEAD2',        '<title>Alleged</title>\n</head>\n');
define('__ROBOT1',       '<meta name="robots" content="noindex">\n<meta name="robots" content="noarchive,follow">\n');
define('__NOCOLLECT1',   '<meta name="no-email-collection" content="/">\n');
define('__TOP1',         '<body>\n<center>\n');
define('__EMAIL1A',      '<a href="mailto:');
define('__EMAIL1B',      '" style="display: none;">');
define('__EMAIL1C',      '</a>');
define('__EMAIL2A',      '<a href="mailto:');
define('__EMAIL2B',      '" style="display:none;">');
define('__EMAIL2C',      '</a>');
define('__EMAIL3A',      '<a style="display: none;" href="mailto:');
define('__EMAIL3B',      '">');
define('__EMAIL3C',      '</a>');
define('__EMAIL4A',      '<a style="display:none;" href="mailto:');
define('__EMAIL4B',      '">');
define('__EMAIL4C',      '</a>');
define('__EMAIL5A',      '<a href="mailto:');
define('__EMAIL5B',      '"></a>');
define('__EMAIL5C',      '..');
define('__EMAIL6A',      '<span style="display: none;"><a href="mailto:');
define('__EMAIL6B',      '">');
define('__EMAIL6C',      '</a></span>');
define('__EMAIL7A',      '<span style="display:none;"><a href="mailto:');
define('__EMAIL7B',      '">');
define('__EMAIL7C',      '</a></span>');
define('__EMAIL8A',      '<!-- <a href="mailto:');
define('__EMAIL8B',      '">');
define('__EMAIL8C',      '</a> -->');
define('__EMAIL9A',      '<div id="'.__DIV1.'"><a href="mailto:');
define('__EMAIL9B',      '">');
define('__EMAIL9C',      '</a></div><br><script language="JavaScript" type="text/javascript">document.getElementById(\''.__DIV1.'\').innerHTML=\'\';</script>');
define('__EMAIL10A',     '<a href="mailto:');
define('__EMAIL10B',     '"><!-- ');
define('__EMAIL10C',     ' --></a>');
define('__LEGAL1',       '');
define('__LEGAL2',       '\n');
define('__STYLE1',       '\n<style>a.'.__CLASS_STYLE_1.'{color:#FFF;font:bold 10px arial,sans-serif;text-decoration:none;}</style>');
define('__VANITY1',      '<table cellspacing="0"cellpadding="0"border="0"style="background:#999;width:230px;"><tr><td valign="top"style="padding: 1px 2px 5px 4px;border-right:solid 1px #CCC;"><span style="font:bold 30px arial,sans-serif;color:#666;top:0px;position:relative;">@</span></td><td valign="top" align="left" style="padding:3px 0 0 4px;"><a href="http://www.projecthoneypot.org/" class="'.__CLASS_STYLE_1.'">'.__VANITY_L1.'</a><br><a href="http://www.unspam.com"class="'.__CLASS_STYLE_1.'">'.__VANITY_L2.'<br>'.__VANITY_L3.'</a></td></tr></table>\n');
define('__BOTTOM1',      '</center>\n</body>\n</html>\n');


function getLegalContent() { return '<table cellspacing="0" cellpadding="0" border="0"><tr>\n<td style="font-family: monospace;"><b><font color=#FFFFFF>o</font></b>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br>&nbsp;<br>The websit<br>to &#121;ou &#115;ub<br>o&#116;he<span style="display:none">design</span>r term<br>Website<font color=#FFFFFF>d</font>yo<br>read<font color=#FFFFFF>t</font>the&#109; <br>agents o&#102; <br>them. The <br>non-transf<br>W&#101;bsite.<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp;<br>S&#112;eci&#97;l re<br>Non-Human<font color=#FFFFFF>a</font><br>spiders, b<br>pr&#111;gr&#97;ms d<br>a&#117;t&#111;matic&#97;<br><br>Email addr<br>I<span style="display:none">recessional correct</span>t i&#115;<font color=#FFFFFF>e</font>rec&#111;<br>alone. Y&#111;&#117;<br>has a v&#97;lu<br>storage, &#97;<br>value of t<br>storing th<br>&#97;gree&#109;ent <br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp;<br>Each pa&#114;t&#121;<br>against th<br>("&#74;udi&#99;ial<br>&#116;&#104;e regist<br>&#115;uch laws <br>and &#112;erfor<br>of f&#101;der&#97;l<br>any<font color=#FFFFFF>h</font>action<br>&#83;erv&#105;ce. Y<br>th&#101; a&#98;ove<font color=#FFFFFF>o</font><br><br><b><font color=#FFFFFF>p</font><font color=#FFFFFF>a</font></b>&nbsp;<b><font color=#FFFFFF>h</font></b>&nbsp;<b><font color=#FFFFFF>c</font></b>&nbsp; &nbsp; <br>&nbsp;<br>You &#99;ons&#101;n<br>m&#97;y ap&#112;ear<br>&#97;b<span style="display:none">neighbour talk chain</span>u&#115;e. The<br>Visitor&#115; a<br><br>VISIT&#79;&#82;S A<br>PARTY OR S<br>SU&#66;SEQUENT<br></td>\n<td style="font-family: monospace;">&nbsp; <b><font color=#FFFFFF>i</font></b>&nbsp; &nbsp; &nbsp;&nbsp; <br><br>e from w&#104;i<br>j&#101;c&#116; to th<br>s govern<span style="display:none">tradein editor</span>in<br>u acc<span style="display:none">fluty diatomic carbonic</span>ept &#116;<br>carefully.<br>the<font color=#FFFFFF>o</font>indi<span style="display:none">grade shot</span>v&#105;<br>acc&#101;ss ri&#103;<br>erable wit<br><br><br>&nbsp; <b><font color=#FFFFFF>s</font></b>&nbsp; <b>SP<span style="display:none">clerk effectiveness</span>E&#67;I</b><br><br>strictions<br>Visit&#111;rs. <br>ots,<font color=#FFFFFF>t</font>index<br>es<span style="display:none">uttermost</span>ign&#101;d to<br>ll&#121;.<br><br>ess&#101;s o&#110; t<br>gni&#122;e&#100; tha<br>&nbsp;acknowled<br>e not less<br>&#110;d/or di&#115;t<br>hese addre<br>i&#115;<font color=#FFFFFF>f</font>&#87;ebsite<br>a&#110;d &#101;x&#112;re&#115;<br><br>&nbsp; <b><font color=#FFFFFF>e</font></b>&nbsp; &nbsp; &nbsp;&nbsp; <br><br><font color=#FFFFFF>t</font>&#97;&#103;rees th<br>e othe&#114; i&#110;<br>&nbsp;Actio&#110;") <br>&#101;red &#65;dmin<br>are applie<br>med &#101;n&#116;&#105;re<br>&nbsp;and state<br>&nbsp;brought a<br>ou c&#111;ns&#101;nt<br>&#97;gree&#109;ent&#46;<br><br>&nbsp; &nbsp; <b><font color=#FFFFFF>p</font></b>&nbsp; <b><font color=#FFFFFF>h</font></b>&nbsp; <br><br>t t&#111; hav&#105;n<br>&nbsp;som&#101;where<br>&nbsp;Ident&#105;fie<br>gree not t<br><br>GREE THAT <br>ENDIN&#71; ANY<br>&nbsp;BREAC&#72; OF<br></td>\n<td style="font-family: monospace;"><b><font color=#FFFFFF>f</font></b>&nbsp; &nbsp; &nbsp; <b>&#84;ER</b><br><br>ch you<font color=#FFFFFF>i</font>acc<br>e &#102;o&#108;low&#105;n<br>&#103; access t<br>h<span style="display:none">theory cm</span>ese t&#101;rms<br><font color=#FFFFFF>a</font>&#65;ny Non-H<br>&#100;ual(s)<font color=#FFFFFF>p</font>wh<br>ht&#115; gran&#116;e<br>hout<font color=#FFFFFF>h</font>&#116;he e<br><br><br><b>AL</b>&nbsp;<b>LICEN<span style="display:none">nameless matrons domain oldtime tennis</span>SE</b><br><br>&nbsp;o<span style="display:none">handicapped waterborne amnesty aftermost salaried</span>n a &#118;isi<br>Non-Hum&#97;n <br>ers, ro&#98;ot<br>&nbsp;access<span style="display:none">grazioso dusty encyclical exuberant spongy</span>, r<br><br><br>his site a<br>t thes&#101; em<br>g&#101; and &#97;gr<br>&nbsp;tha&#110; US $<br>&#114;ibution<font color=#FFFFFF>d</font>&#111;<br>&#115;ses. Int<span style="display:none">authority outside</span>e<br>\'s em&#97;il a<br>s&#108;y &#112;r&#111;h&#105;b<br><br><b><font color=#FFFFFF>a</font></b>&nbsp; &nbsp; <b>APP&#76;&#73;</b><br><br>at a&#110;y sui<br>&nbsp;connectio<br>&#115;hall be<font color=#FFFFFF>d</font>g<br>is&#116;&#114;&#97;tive<font color=#FFFFFF>t</font><br>d to a&#103;ree<br>ly wit&#104;in<font color=#FFFFFF>t</font><br>&nbsp;co&#117;rts wi<span style="display:none">pathetic</span><br>&#103;a&#105;nst him<br>&nbsp;t&#111; elec&#116;r<br><br><br>&nbsp;&nbsp; <b><font color=#FFFFFF>p</font>RECORD</b><br><br>g &#121;our In&#116;<br>&nbsp;on<font color=#FFFFFF>d</font>thi&#115; p<br>r is uniqu<br>o use this<br><br>HARVESTING<span style="display:none">intake presbyterian</span><br>&nbsp;MESSA&#71;E(S<br>&nbsp;TH&#69;SE TER<br></td>\n<td style="font-family: monospace;"><b>MS</b>&nbsp;<b>AND</b>&nbsp;<b>&#67;ON</b><br><br>e&#115;&#115;ed this<br>g &#99;o&#110;ditio<br>o the<font color=#FFFFFF>g</font>Webs<br>&nbsp;and<font color=#FFFFFF>e</font>condi<br>um&#97;n Visi<span style="display:none">standup completion secondclass</span>t<br>o co&#110;&#116;rols<br>d to yo&#117; u<br>&#120;press wr&#105;<br><br><br><b><font color=#FFFFFF>t</font>RESTRICTI</b><br><br>tor\'s<span style="display:none">melodic direct past kangaroos madly</span>&nbsp;lice<br>Visitors i<br>s&#44; crawle&#114;<br>ead, compi<br><br><br>re &#99;ons&#105;de<span style="display:none">submarine distinctive</span><br>ail addr&#101;s<br>ee tha&#116; &#101;a<br>&#53;0&#46; &#89;ou fu<br>f these a&#100;<br>nti&#111;nal c&#111;<br>ddresses i<br>ited.<br><br><b>CAB&#76;&#69;<font color=#FFFFFF>d</font>LA&#87;</b>&nbsp;<br><br>t,<font color=#FFFFFF>i</font>&#97;ction <br>n w&#105;t&#104; or <br>overne&#100;<font color=#FFFFFF>t</font>b&#121;<br>Contact (t<br>ments betw<br>th&#101; &#65;dmin <br>thin<font color=#FFFFFF>g</font>t&#104;e A<br>&nbsp;in con&#110;ec<br>onic &#115;erv<span style="display:none">formation</span>i<br><br><br><b>S</b>&nbsp;<b>OF<span style="display:none">large sweet lost supply queen</span></b>&nbsp;<b>VISIT</b><br><br>ernet &#80;rot<br>&#97;ge (&#116;he "<br>ely<font color=#FFFFFF>a</font>matc&#104;e<br>&nbsp;addr<span style="display:none">silver print budget</span>ess f<br><br>, GATHERIN<br>) TO &#84;HE I<br>MS OF SERV<br></td>\n<td style="font-family: monospace;"><b>D&#73;TION&#83;</b>&nbsp;<b>OF</b><br><br>&nbsp;agre&#101;ment<br>&#110;s. Thes&#101; <br>i&#116;e.<font color=#FFFFFF>c</font>By vi<br>tions (the<br>o&#114;s t&#111; the<br>, authors <br>nd&#101;r the T<br>tten permi<br><br><br><b>ON&#83;</b>&nbsp;<b>&#70;O&#82;</b>&nbsp;<b>&#78;O</b><br><br>n&#115;e<font color=#FFFFFF>t</font>&#116;o ac&#99;<br>nclu&#100;e, bu<br>s, harvest<br>le or gath<br><br><br>re&#100; prop&#114;i<br>ses a&#114;&#101; pr<span style="display:none">paramilitary slow status demand noisy</span><br>c&#104;<font color=#FFFFFF>s</font>email a<br>rther ag&#114;e<br>dresses<font color=#FFFFFF>g</font>su<br>ll<span style="display:none">dotterel trial</span>ec&#116;io&#110;, <br>s recogniz<br><br><br><b>&#65;ND<font color=#FFFFFF>h</font>J&#85;RISD</b><br><br>or proc&#101;ed<br>aris&#105;n&#103; f&#114;<br><font color=#FFFFFF>c</font>t&#104;e la&#119; o<br>he "Admin <br>een Ad&#109;in <br>Sta&#116;e. Y&#111;u<br>dmin State<br>tion wit<span style="display:none">madly</span>h<font color=#FFFFFF>k</font><br>&#99;e &#111;f pro&#99;<br><br><br><b>O<span style="display:none">stereotyped alveolar inquiry pride</span>R</b>&nbsp;<b>USE</b>&nbsp;<b>&#65;ND</b><br><br>ocol add&#114;&#101;<br>Identif&#105;er<br>d to your <br>or an&#121; re&#97;<br><br>G&#44;<font color=#FFFFFF>o</font>STO&#82;ING<br>&#68;EN&#84;&#73;FIER <br>&#73;CE.<br></td>\n<td style="font-family: monospace;">&nbsp;<b>USE</b>&nbsp;<br><br>&nbsp;("the<font color=#FFFFFF>p</font>Web<br>&#116;erm&#115; are <br>s&#105;ting (in<br>&nbsp;"Terms of<br>&nbsp;Webs&#105;te s<br>or<font color=#FFFFFF>g</font>o&#116;her&#119;&#105;<br>erms of Se<br>ssion<font color=#FFFFFF>g</font>&#111;&#102; t<br><br><br><b>N-H&#85;MAN</b>&nbsp;<b>VI</b><br><br>es&#115;<font color=#FFFFFF>t</font>the W&#101;<br>t<font color=#FFFFFF>c</font>are<font color=#FFFFFF>a</font>&#110;ot <br>ers, or an<br>er content<br><br><br>&#101;t&#97;ry inte<br>o&#118;ided for<br>ddres&#115;<font color=#FFFFFF>a</font>the<br>e tha&#116; t&#104;e<br>bstantiall<br>ha&#114;v<span style="display:none">coming okay torpor</span>esting<br>ed<font color=#FFFFFF>p</font>a&#115; a vi<br><br><br><b>ICTI&#79;N</b>&nbsp;<br><br>ing brough<br>om the<font color=#FFFFFF>a</font>&#84;er<br>f the &#115;tat<br>&#83;tate")<font color=#FFFFFF>o</font>f&#111;<br>S&#116;at&#101; re&#115;i<br>&nbsp;&#99;ons<span style="display:none">publisher coots</span>ent t<br>. Y&#111;u cons<span style="display:none">hurt odorous</span><br>b&#114;ea&#99;hes o<br>&#101;&#115;s rega&#114;d<br><br><br>&nbsp;<b>ABUSE</b>&nbsp;<br><br>&#115;s record<span style="display:none">burry continuing</span>e<br>") if we s<br>In&#116;&#101;rn&#101;t P<span style="display:none">prose</span><br>son.<br><br>,<font color=#FFFFFF>h</font>TR<span style="display:none">butch parian inn</span>ANSFER<br>CONST&#73;TU&#84;E<br><br></td>\n<td style="font-family: monospace;"><br><br>&#115;&#105;t&#101;") &#105;s <br>i&#110; additio<br>&nbsp;any &#109;anne<br>&nbsp;&#83;ervice")<br>h&#97;ll b<span style="display:none">jumpy extract dispensable caution reaumur</span>e co<br>se makes u<br>rvic&#101; are<br>he &#111;w&#110;er o<br><br><br><b>SIT&#79;RS</b>&nbsp;<br><br>bsite<font color=#FFFFFF>f</font>appl<br>limited t<span style="display:none">plated agency command pronominal</span>o<br>&#121; other co<br><font color=#FFFFFF>o</font>&#102;&#114;om<font color=#FFFFFF>t</font>the <br><br><br>llectual<font color=#FFFFFF>g</font>p<br><font color=#FFFFFF>e</font>&#104;&#117;man vis<br>&nbsp;Websit&#101; c<br>&nbsp;compilati<br>y diminis&#104;<br>, &#103;atherin<br>olation of<br><br><br><br><br>t &#98;y such <br>m&#115; of<font color=#FFFFFF>i</font>Se&#114;v<br>&#101; of resid<br>r t&#104;e Web&#115;<br>de&#110;ts ente<br>o the juri<br>ent to<font color=#FFFFFF>h</font>the<br>f &#116;hes&#101; Te<br>ing action<br><br><br><br><br>d. An e&#109;ai<br>uspect pot<br>&#114;oto&#99;ol a<span style="display:none">rare node chancellor molar eutrophic</span>d<br><br><br>RING<font color=#FFFFFF>t</font>TO A<font color=#FFFFFF>h</font><br>S AN &#65;CCEP<br><br></td>\n<td style="font-family: monospace;"><br><br>pr&#111;vid&#101;d<br>n to any<br>r) the<br>. &#80;lease<br>nsider<span style="display:none">aggressive fool viral</span>e&#100;<br>se of<br><br>f &#116;he<br><br><br><br><br>&#121; to<br>, we&#98;<br>mp&#117;ter<br>Website<br><br><br>roper&#116;y.<br>ito<span style="display:none">quarrelsome typecast</span>rs<br>o<span style="display:none">hesitant semidetached notarial</span>ntains<br>&#111;&#110;,<br>es<font color=#FFFFFF>o</font>&#116;he<br>g&#44; &#97;n&#100;/or<br><font color=#FFFFFF>p</font>&#116;h<span style="display:none">metrical</span>i&#115;<br><br><br><br><br>p&#97;rty<br>i&#99;e<br>ence of<br>ite as<br>red into<br>sdiction<br>&nbsp;venue in<br>r&#109;s of<br>s under<br><br><br><br><br>l add&#114;ess<br>e<span style="display:none">polycarpic photo unnumbered skirt evanescent</span>nti&#97;l<br>d&#114;&#101;s&#115;.<br><br><br>THIRD<br>&#84;A<span style="display:none">backed quiet computers</span>NC&#69; AND<br><br></td>\n</tr>\n</table>\n<br>'; }


?><?php 

// 
// PROXY SUPPORT
//  
// This honey pot script supports Proxies. If your webserver requires a proxy
// for outbound connections you may configure this honey pot's settings to use
// a proxy.
//
// For more information, visit: 
//     http://www.projecthoneypot.org/settings_help.php
//
//



function formatHTML($s) {
    return str_replace('\n',"\n",$s);
}

function getDocType()       { return formatHTML(__DOC_TYPE1); }
function getHeadHTML1()     { return formatHTML(__HEAD1); }
function getRobotHTML()     { return formatHTML(__ROBOT1); }
function getNoCollectHTML() { return formatHTML(__NOCOLLECT1); }
function getHeadHTML2()     { return formatHTML(__HEAD2); }
function getTopHTML()       { return formatHTML(__TOP1); }
function getEmailHTML($method,$m) { 
    switch ($method) {
    case 0: return "";
    case 1: return formatHTML(__EMAIL1A.$m.__EMAIL1B.$m.__EMAIL1C); 
    case 2: return formatHTML(__EMAIL2A.$m.__EMAIL2B.$m.__EMAIL2C); 
    case 3: return formatHTML(__EMAIL3A.$m.__EMAIL3B.$m.__EMAIL3C); 
    case 4: return formatHTML(__EMAIL4A.$m.__EMAIL4B.$m.__EMAIL4C); 
    case 5: return formatHTML(__EMAIL5A.$m.__EMAIL5B); 
    case 6: return formatHTML(__EMAIL6A.$m.__EMAIL6B.$m.__EMAIL6C); 
    case 7: return formatHTML(__EMAIL7A.$m.__EMAIL7B.$m.__EMAIL7C); 
    case 8: return formatHTML(__EMAIL8A.$m.__EMAIL8B.$m.__EMAIL8C); 
    case 9: return formatHTML(__EMAIL9A.$m.__EMAIL9B.$m.__EMAIL9C); 
    }
    return formatHTML(__EMAIL10A.$m.__EMAIL10B.$m.__EMAIL10C); 
}
function getLegalHTML()   { return formatHTML(__LEGAL1.(getLegalContent()).__LEGAL2); }
function getStyleHTML()   { return formatHTML(__STYLE1); }
function getVanityHTML()  { return formatHTML(__VANITY1); }
function getBottomHTML()  { return formatHTML(__BOTTOM1); }

function readSettings() {
    $settings      = NULL;
    $settings_file = dirname(__FILE__)."/phpot_settings.php";

    if (is_file($settings_file) && is_readable($settings_file)) {
        $fp = fopen($settings_file,"r");
        $contents = "";
        while (!feof($fp)) {
            $contents .= fread($fp, 8192);
        }
        fclose($fp);

        $lines = explode("\n",$contents);
        foreach ($lines as $line) {
            if (trim($line) !== "") {
                list ($setting, $value) = @explode(":",$line,2);
                switch ($setting) {
                case "proxy_host": 
                    $settings["sock_host"] = trim($value);
                    break;
                case "proxy_port":
                    $settings["sock_port"] = trim($value);
                    break;
                }
                if (trim($value) !== "") {
                    $settings[trim($setting)] = trim($value);
                }
            }
        }
    }

    if (isset($settings["proxy_host"]) && isset($settings["proxy_port"]) && !isset($settings["use_proxy"])) {
        $settings["use_proxy"] = "1";
    } else {
        $settings["use_proxy"] = "0";
    }

    if (isset($settings["proxy_user"]) && isset($settings["proxy_pass"]) && !isset($settings["proxy_auth"])) {
        $settings["proxy_auth"] = "basic";
    } else {
        $settings["proxy_auth"] = "none";
    }

    if (!isset($settings["sock_host"])) $settings["sock_host"] = __REQUEST_HOST;
    if (!isset($settings["sock_port"])) $settings["sock_port"] = __REQUEST_PORT;

    return $settings;
}

function performRequest($request) {
    $response = "";

    $settings = readSettings();

    if ($settings["use_proxy"] == "1") {
        // POST via proxy
        $post_url = "http://".__REQUEST_HOST.":".__REQUEST_PORT.__REQUEST_SCRIPT;

        $head  = "POST ".$post_url." HTTP/1.0\r\n";
        //$head .= "Host: ".__REQUEST_HOST."\r\n";
        $head .= "User-Agent: PHPot ".__HPOT_TAG2."\r\n";
        if ($settings["proxy_auth"] == "basic") {
            $head .= "Proxy-Authorization: Basic ".base64_encode($settings["proxy_user"].":".$settings["proxy_pass"])."\r\n";
        }
        $head .= "Cache-Control: no-store, no-cache\r\n";
        $head .= "Accept: */*\r\n";
        $head .= "Pragma: no-cache\r\n";
        $head .= "Content-Type: application/x-www-form-urlencoded\r\n";
        $head .= "Content-Length: ".strlen($request)."\r\n";
        $head .= "Connection: close\r\n\r\n";

    } else {
        // POST directly
        $head  = "POST ".__REQUEST_SCRIPT." HTTP/1.1\r\n";
        $head .= "Host: ".__REQUEST_HOST."\r\n";
        $head .= "User-Agent: PHPot ".__HPOT_TAG2."\r\n";
        $head .= "Content-Type: application/x-www-form-urlencoded\r\n";
        $head .= "Content-Length: ".strlen($request)."\r\n";
        $head .= "Connection: close\r\n\r\n";
    }
    
    $errno  = NULL;
    $errstr = NULL;
    $fd = @fsockopen ($settings["sock_host"], $settings["sock_port"], $errno, $errstr, 20);

    if (!$fd) {
        // Socket Error
        die("\n<BR>Unable to contact the Server. Are outbound connections disabled? (If a proxy is required for outbound traffic, you may configure the honey pot to use a proxy. For instructions, visit http://www.projecthoneypot.org/settings_help.php)<BR>\n");
        return "-1";
    } else {

        fputs($fd,$head.$request);
        while(!feof($fd)) {
            $response .= fgets($fd,4096);
        }
        fclose($fd);
    }

    return $response;
}

function prepareRequest() {
    $postvars          = array();
    $postvars["tag1"]  = __HPOT_TAG1;
    $postvars["tag2"]  = __HPOT_TAG2;
    $postvars["tag3"]  = __HPOT_TAG3;
    if (!($handle = fopen(__FILE__,"r"))) {
        die("\n<BR>Unable to read contents of ".__FILE__." for hashing<BR>\n");
        return -2;
    }
    $contents = "";
    while (!feof($handle)) {
        $contents .= fread($handle, 8192);
    }
    fclose($handle);
    $postvars["tag4"]   = md5(preg_replace("/[^a-zA-Z0-9]/","",$contents));
    $postvars["ip"]    = $_SERVER["REMOTE_ADDR"];
    $postvars["svrn"]  = $_SERVER["SERVER_NAME"];  
    $postvars["svp"]   = $_SERVER["SERVER_PORT"];  
    $postvars["svip"]  = isset($_SERVER["SERVER_ADDR"]) ? $_SERVER["SERVER_ADDR"] : "";
    $postvars["rquri"]   = isset($_SERVER["REQUEST_URI"]) ? $_SERVER["REQUEST_URI"] : "";
    $postvars["phpself"] = str_replace(' ','%20',$_SERVER["PHP_SELF"]);
    $postvars["version"] = "php-".phpversion();
    $postvars["sn"]     = str_replace(' ','%20',$_SERVER["SCRIPT_NAME"]);
    $postvars["ref"]    = isset($_SERVER["HTTP_REFERER"]) ? $_SERVER["HTTP_REFERER"] : "";
    $postvars["uagnt"]  = isset($_SERVER["HTTP_USER_AGENT"]) ? $_SERVER["HTTP_USER_AGENT"] : "";
    if (isset($_POST) && count($_POST) > 0) {
        $postvars["has_post"] = count($_POST);
        for (reset($_POST);list($k,$v) = each($_POST);) {
            $postvars["post|".$k] = $v;
        }
        reset($_POST);
    }
    if (isset($_GET) && count($_GET) > 0) {
        $postvars["has_get"] = count($_GET);
        for (reset($_GET);list($k,$v) = each($_GET);) {
            $postvars["get|".$k] = $v;
        }
        reset($_GET);
    }
    if (isset($_SERVER) && count($_SERVER) > 0) {
        $i = 0;
        for (reset($_SERVER);list($k,$v) = each($_SERVER);) {
            if ($k !== "HTTP_COOKIE" && preg_match('/^HTTP_/',$k)) {
                $postvars["header|".$k] = $v;
                $i++;
            }
        }
        $postvars["has_header"] = $i;
        reset($_SERVER);
    }

    return $postvars;
}

function transcribeResponse(& $response) {
    $settings  = NULL;
    $arr       = explode("\n",$response);
    $isParam   = FALSE;

    
    for ($i=0;list(,$v)=each($arr);$i++) {
        if ($v == "<END>")   $isParam = FALSE;

        if ($isParam) {          
            $pieces = explode("=",$v,2);
            $settings[$pieces[0]] = urldecode($pieces[1]);
        }
        if ($v == "<BEGIN>") $isParam = TRUE;
    }
    

    if (isset($settings["directives"])) {
        $settings["directives"] = explode(",",$settings["directives"]);
    }

    return $settings;
}

header("Cache-Control: no-store, no-cache");
header("Pragma: no-cache");

$response  = "";
$request   = "";
$post      = prepareRequest();

for (reset($post);list($k,$v) = each($post);) {
    $request .= "&".urlencode($k)."=".urlencode(stripslashes($v));
}
$request    = substr($request,1);
$response   = performRequest($request);
if ($response == "-1") {
    exit();
}
$settings   = transcribeResponse($response);

$directives   = $settings["directives"];
$email        = isset($settings["email"]) ? $settings["email"] : "";
$emailmethod  = isset($settings["emailmethod"]) ? $settings["emailmethod"] : 0;




?>
<?php echo (isset($directives[0]) && $directives[0]==1) ? getDocType()    : ""; ?>
<?php echo (isset($settings["injDocType"])) ? formatHTML($settings["injDocTypeMsg"]) : ""; ?>
<?php echo (isset($directives[1]) && $directives[1]==1) ? getHeadHTML1()   : ""; ?>
<?php echo (isset($settings["injHead1HTML"])) ? formatHTML($settings["injHead1HTMLMsg"]) : ""; ?>
<?php echo (isset($directives[8]) && $directives[8]==1) ? getRobotHTML()   : ""; ?>
<?php echo (isset($settings["injRobotHTML"])) ? formatHTML($settings["injRobotHTMLMsg"]) : ""; ?>
<?php echo (isset($directives[9]) && $directives[9]==1) ? getNoCollectHTML()   : ""; ?>
<?php echo (isset($settings["injNoCollectHTML"])) ? formatHTML($settings["injNoCollectHTMLMsg"]) : ""; ?>
<?php echo (isset($directives[1]) && $directives[1]==1) ? getHeadHTML2()   : ""; ?>
<?php echo (isset($settings["injHead2HTML"])) ? formatHTML($settings["injHead2HTMLMsg"]) : ""; ?>
<?php echo (isset($directives[2]) && $directives[2]==1) ? getTopHTML()    : ""; ?>
<?php echo (isset($settings["injTopHTML"])) ? formatHTML($settings["injTopHTMLMsg"]) : ""; ?>
<?php
   if (isset($settings["actMsgOn"])) { 
       echo formatHTML($settings["actMsg"]); 
   }
   if (isset($settings["errMsgOn"])) { 
       echo formatHTML($settings["errMsg"]); 
   }
   if (isset($settings["customMsgOn"])) { 
       echo formatHTML($settings["customMsg"]); 
   }
?>
<?php echo (isset($directives[3]) && $directives[3]==1) ? getLegalHTML()  : ""; ?>
<?php echo (isset($settings["injLegalHTML"])) ? formatHTML($settings["injLegalHTMLMsg"]) : ""; ?>
<?php
   if (isset($settings["altLegalOn"])) { 
       echo formatHTML($settings["altLegalMsg"]); 
   } 
?>
<?php echo (isset($directives[4]) && $directives[4]==1) ? getEmailHTML(intval($emailmethod),$email)  : ""; ?>
<?php echo (isset($settings["injEmailHTML"])) ? formatHTML($settings["injEmailHTMLMsg"]) : ""; ?>
<?php echo (isset($directives[5]) && $directives[5]==1) ? getStyleHTML()  : ""; ?>
<?php echo (isset($settings["injStyleHTML"])) ? formatHTML($settings["injStyleHTMLMsg"]) : ""; ?>
<?php echo (isset($directives[6]) && $directives[6]==1) ? getVanityHTML() : ""; ?>
<?php echo (isset($settings["injVanityHTML"])) ? formatHTML($settings["injVanityHTMLMsg"]) : ""; ?>
<?php
   if (isset($settings["altVanityOn"])) {
        echo formatHTML($settings["altVanityMsg"]);
    }
?>
<?php echo (isset($directives[7]) && $directives[7]==1) ? getBottomHTML() : ""; ?>
<?php echo (isset($settings["injBottomHTML"])) ? formatHTML($settings["injBottomHTMLMsg"]) : ""; ?>
